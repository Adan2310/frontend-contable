"use strict";(self["webpackChunkfrontend_contable"]=self["webpackChunkfrontend_contable"]||[]).push([[534],{2118:function(e,o,t){t.d(o,{A:function(){return u}});var a=t(6768),l=t.p+"img/image.f199c5ca.png";const i={class:"barra-lateral"},r={class:"settings-section"};function n(e,o,t,n,s,c){const d=(0,a.g2)("router-link");return(0,a.uX)(),(0,a.CE)("div",i,[o[6]||(o[6]=(0,a.Lk)("div",{class:"logo"},[(0,a.Lk)("img",{src:l,alt:"Logo",class:"logo-img"}),(0,a.Lk)("span",{class:"logo-text"},"JAVB")],-1)),(0,a.Lk)("ul",null,[(0,a.Lk)("li",null,[(0,a.bF)(d,{to:"/home",class:"menu-item","active-class":"active"},{default:(0,a.k6)((()=>o[1]||(o[1]=[(0,a.eW)(" HOME ")]))),_:1})]),(0,a.Lk)("li",null,[(0,a.bF)(d,{to:"/contactos",class:"menu-item","active-class":"active"},{default:(0,a.k6)((()=>o[2]||(o[2]=[(0,a.eW)(" CONTACTOS ")]))),_:1})]),(0,a.Lk)("li",null,[(0,a.bF)(d,{to:"/ventas",class:"menu-item","active-class":"active"},{default:(0,a.k6)((()=>o[3]||(o[3]=[(0,a.eW)(" FACTURAS ")]))),_:1})]),(0,a.Lk)("li",null,[(0,a.bF)(d,{to:"/facturas-recurrentes",class:"menu-item","active-class":"active"},{default:(0,a.k6)((()=>o[4]||(o[4]=[(0,a.eW)(" FACTURAS RECURRENTES ")]))),_:1})]),(0,a.Lk)("li",null,[(0,a.bF)(d,{to:"/cotizaciones",class:"menu-item","active-class":"active"},{default:(0,a.k6)((()=>o[5]||(o[5]=[(0,a.eW)(" COTIZACIONES ")]))),_:1})])]),(0,a.Lk)("div",r,[(0,a.Lk)("button",{onClick:o[0]||(o[0]=(...e)=>c.logout&&c.logout(...e)),class:"logout-btn"}," CERRAR SESIÓN ")])])}t(4114);var s={methods:{logout(){localStorage.clear(),this.$router.push("/")}}},c=t(1241);const d=(0,c.A)(s,[["render",n],["__scopeId","data-v-76605de2"]]);var u=d},3697:function(e,o,t){t.d(o,{A:function(){return z}});var a=t(6768),l=t(4232),i=t(5130);const r=["src"],n={class:"user-info"},s={class:"user-name"},c={class:"user-role"},d={key:0,class:"dialog-overlay"},u={class:"dialog"},m={class:"form-group"},p=["src"],k={class:"form-group"},f={class:"form-group"},h={class:"form-group"},b={class:"form-group"},L={class:"button-group"};function g(e,o,t,g,v,C){return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.Lk)("div",{class:"user-bar",onClick:o[0]||(o[0]=(...e)=>C.openUserDialog&&C.openUserDialog(...e))},[(0,a.Lk)("img",{src:v.userProfileImage||v.defaultImage,alt:"Imagen de usuario",class:"profile-picture"},null,8,r),(0,a.Lk)("div",n,[(0,a.Lk)("span",s,(0,l.v_)(v.usuario||"USUARIO"),1),(0,a.Lk)("span",c,(0,l.v_)(v.apodo||"APODO"),1)])]),v.showDialog?((0,a.uX)(),(0,a.CE)("div",d,[(0,a.Lk)("div",u,[o[13]||(o[13]=(0,a.Lk)("h3",{class:"dialog-title"},"Información del Usuario",-1)),(0,a.Lk)("form",{onSubmit:o[7]||(o[7]=(0,i.D$)(((...e)=>C.updateUser&&C.updateUser(...e)),["prevent"]))},[(0,a.Lk)("div",m,[(0,a.Lk)("img",{src:v.userProfileImage||v.defaultImage,alt:"Imagen de perfil",class:"profile-image-preview"},null,8,p)]),(0,a.Lk)("div",k,[o[8]||(o[8]=(0,a.Lk)("label",{for:"profileImage"},"Actualizar Foto de Perfil:",-1)),(0,a.Lk)("input",{type:"file",id:"profileImage",onChange:o[1]||(o[1]=(...e)=>C.onFileChange&&C.onFileChange(...e))},null,32)]),(0,a.Lk)("div",f,[o[9]||(o[9]=(0,a.Lk)("label",{for:"usuario"},"Usuario:",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",id:"usuario","onUpdate:modelValue":o[2]||(o[2]=e=>v.editableUser.usuario=e),required:""},null,512),[[i.Jo,v.editableUser.usuario]])]),(0,a.Lk)("div",h,[o[10]||(o[10]=(0,a.Lk)("label",{for:"apodo"},"Apodo:",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",id:"apodo","onUpdate:modelValue":o[3]||(o[3]=e=>v.editableUser.apodo=e),required:""},null,512),[[i.Jo,v.editableUser.apodo]])]),(0,a.Lk)("div",b,[o[11]||(o[11]=(0,a.Lk)("label",{for:"password"},"Nueva Contraseña:",-1)),(0,a.bo)((0,a.Lk)("input",{type:"password",id:"password","onUpdate:modelValue":o[4]||(o[4]=e=>v.editableUser.password=e),placeholder:"Dejar vacío para no cambiar"},null,512),[[i.Jo,v.editableUser.password]])]),(0,a.Lk)("div",L,[o[12]||(o[12]=(0,a.Lk)("button",{type:"submit",class:"save-button"},"Guardar Cambios",-1)),(0,a.Lk)("button",{type:"button",onClick:o[5]||(o[5]=(...e)=>C.deleteUser&&C.deleteUser(...e)),class:"delete-button"}," Eliminar Usuario "),(0,a.Lk)("button",{type:"button",onClick:o[6]||(o[6]=(...e)=>C.closeUserDialog&&C.closeUserDialog(...e)),class:"close-button"}," Cerrar ")])],32)])])):(0,a.Q3)("",!0)])}t(4114),t(4603),t(7566),t(8721);var v=t(4373),C={data(){return{showDialog:!1,usuario:"",apodo:"",userProfileImage:"",defaultImage:"https://via.placeholder.com/50",editableUser:{usuario:"",apodo:"",password:"",profileImage:null},profileImage:null,backendUrl:"http://localhost:3000"}},created(){this.loadUserData()},methods:{async loadUserData(){try{const e=localStorage.getItem("token"),o=localStorage.getItem("id");if(!o||!e)return void console.error("No se encontró el ID del usuario o el token en el almacenamiento local.");const t=await v.A.get(`${this.backendUrl}/api/usuario/getbyId/${o}`,{headers:{Authorization:`Bearer ${e}`}});this.usuario=t.data.usuario||"USUARIO",this.apodo=t.data.apodo||"APODO",this.userProfileImage=this.getFullImageUrl(t.data.profileImage),this.editableUser=t.data}catch(e){console.error("Error al cargar los datos del usuario:",e)}},openUserDialog(){this.showDialog=!0},closeUserDialog(){this.showDialog=!1},getFullImageUrl(e){return`${this.backendUrl}${e}`},onFileChange(e){this.profileImage=e.target.files[0],this.userProfileImage=URL.createObjectURL(this.profileImage)},async updateUser(){try{const e=localStorage.getItem("token"),o=localStorage.getItem("id");if(!o||!e)return void alert("No se encontró el ID del usuario o el token en el almacenamiento local.");const t=new FormData;t.append("usuario",this.editableUser.usuario),t.append("apodo",this.editableUser.apodo),this.editableUser.password&&t.append("password",this.editableUser.password),this.profileImage&&t.append("profileImage",this.profileImage),await v.A.put(`${this.backendUrl}/api/usuario/update/${o}`,t,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"multipart/form-data"}}),this.usuario=this.editableUser.usuario,this.apodo=this.editableUser.apodo,alert("Información actualizada correctamente."),this.closeUserDialog()}catch(e){console.error("Error al actualizar usuario:",e),alert("No se pudo actualizar la información.")}},async deleteUser(){try{const e=localStorage.getItem("token"),o=localStorage.getItem("id");if(!o||!e)return void alert("No se encontró el ID del usuario o el token en el almacenamiento local.");await v.A.delete(`${this.backendUrl}/api/usuario/delete/${o}`,{headers:{Authorization:`Bearer ${e}`}}),alert("Usuario eliminado correctamente."),localStorage.clear(),this.$router.push("/")}catch(e){console.error("Error al eliminar usuario:",e),alert("No se pudo eliminar el usuario.")}}}},U=t(1241);const I=(0,U.A)(C,[["render",g],["__scopeId","data-v-999e8b52"]]);var z=I},9e3:function(e,o,t){t.r(o),t.d(o,{default:function(){return K}});var a=t(6768),l=t(4232),i=t(5130);const r={class:"page-container"},n={class:"main-content"},s={class:"content"},c={class:"header"},d={class:"table-section"},u={class:"table-container"},m=["onClick"],p=["onClick"],k={key:0,class:"modal-overlay fullscreen"},f={class:"modal fullscreen-content"},h={class:"modal-title"},b={class:"form-header"},L={class:"form-group"},g={class:"form-group"},v={class:"form-group"},C={class:"form-group"},U={class:"form-row"},I={class:"form-group"},z={class:"form-group"},y={class:"form-group"},A={class:"table-container"},V=["onUpdate:modelValue"],E=["onUpdate:modelValue"],w=["onUpdate:modelValue"],D=["onUpdate:modelValue"],F=["onUpdate:modelValue"],_=["onUpdate:modelValue"],J=["onUpdate:modelValue"],S=["onClick"],$={class:"form-row"},N={class:"form-group"},O={class:"form-group"},q={class:"form-group"},M={class:"form-group full-width"},R={class:"form-footer"},T={type:"submit",class:"save-button"};function x(e,o,t,x,P,X){const B=(0,a.g2)("BarraLateral"),W=(0,a.g2)("Userbar");return(0,a.uX)(),(0,a.CE)("div",r,[(0,a.bF)(B),(0,a.Lk)("div",n,[(0,a.bF)(W),(0,a.Lk)("main",s,[(0,a.Lk)("header",c,[o[15]||(o[15]=(0,a.Lk)("div",{class:"header-left"},[(0,a.Lk)("h1",{class:"title"},"COTIZACIONES")],-1)),(0,a.Lk)("button",{class:"add-contact-button",onClick:o[0]||(o[0]=(...e)=>X.openAddCotizacionModal&&X.openAddCotizacionModal(...e))}," + Agregar nueva Cotización ")]),(0,a.Lk)("section",d,[(0,a.Lk)("div",u,[(0,a.Lk)("table",null,[o[16]||(o[16]=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("th",null,"Número Cotización"),(0,a.Lk)("th",null,"Cliente"),(0,a.Lk)("th",null,"Teléfono"),(0,a.Lk)("th",null,"Total"),(0,a.Lk)("th",null,"Estado"),(0,a.Lk)("th",null,"Acciones")])],-1)),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(P.cotizaciones,(e=>((0,a.uX)(),(0,a.CE)("tr",{key:e.id},[(0,a.Lk)("td",null,(0,l.v_)(e.numeroCotizacion),1),(0,a.Lk)("td",null,(0,l.v_)(e.cliente),1),(0,a.Lk)("td",null,(0,l.v_)(e.telefono),1),(0,a.Lk)("td",null,(0,l.v_)(e.total),1),(0,a.Lk)("td",null,(0,l.v_)(e.estado),1),(0,a.Lk)("td",null,[(0,a.Lk)("button",{class:"edit-button",onClick:o=>X.editCotizacion(e.id)}," ✏️ ",8,m),(0,a.Lk)("button",{class:"delete-button",onClick:o=>X.deleteCotizacion(e.id)}," 🗑️ ",8,p)])])))),128))])])])]),P.showModal?((0,a.uX)(),(0,a.CE)("div",k,[(0,a.Lk)("div",f,[(0,a.Lk)("h2",h,(0,l.v_)(P.isEditing?"Editar Cotización":"Nueva Cotización"),1),(0,a.Lk)("form",{onSubmit:o[14]||(o[14]=(0,i.D$)(((...e)=>X.saveCotizacion&&X.saveCotizacion(...e)),["prevent"]))},[(0,a.Lk)("div",b,[(0,a.Lk)("div",L,[o[17]||(o[17]=(0,a.Lk)("label",{for:"numeroCotizacion"},"Número Cotización*",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",id:"numeroCotizacion","onUpdate:modelValue":o[1]||(o[1]=e=>P.form.numeroCotizacion=e),placeholder:"Ingrese un número único",required:""},null,512),[[i.Jo,P.form.numeroCotizacion]])]),(0,a.Lk)("div",g,[o[18]||(o[18]=(0,a.Lk)("label",{for:"cliente"},"Cliente*",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",id:"cliente","onUpdate:modelValue":o[2]||(o[2]=e=>P.form.cliente=e),placeholder:"Buscar cliente",required:""},null,512),[[i.Jo,P.form.cliente]])]),(0,a.Lk)("div",v,[o[19]||(o[19]=(0,a.Lk)("label",{for:"idImpuesto"},"ID Impuesto*",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",id:"idImpuesto","onUpdate:modelValue":o[3]||(o[3]=e=>P.form.idImpuesto=e),placeholder:"Ingrese el ID de Impuesto del cliente",required:""},null,512),[[i.Jo,P.form.idImpuesto]])]),(0,a.Lk)("div",C,[o[20]||(o[20]=(0,a.Lk)("label",{for:"telefono"},"Teléfono*",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",id:"telefono","onUpdate:modelValue":o[4]||(o[4]=e=>P.form.telefono=e),required:""},null,512),[[i.Jo,P.form.telefono]])])]),(0,a.Lk)("div",U,[(0,a.Lk)("div",I,[o[21]||(o[21]=(0,a.Lk)("label",{for:"fechaCreacion"},"Fecha de Creación*",-1)),(0,a.bo)((0,a.Lk)("input",{type:"date",id:"fechaCreacion","onUpdate:modelValue":o[5]||(o[5]=e=>P.form.fechaCreacion=e),required:""},null,512),[[i.Jo,P.form.fechaCreacion]])]),(0,a.Lk)("div",z,[o[22]||(o[22]=(0,a.Lk)("label",{for:"fechaVencimiento"},"Fecha de Vencimiento*",-1)),(0,a.bo)((0,a.Lk)("input",{type:"date",id:"fechaVencimiento","onUpdate:modelValue":o[6]||(o[6]=e=>P.form.fechaVencimiento=e),required:""},null,512),[[i.Jo,P.form.fechaVencimiento]])]),(0,a.Lk)("div",y,[o[24]||(o[24]=(0,a.Lk)("label",{for:"estado"},"Estado*",-1)),(0,a.bo)((0,a.Lk)("select",{id:"estado","onUpdate:modelValue":o[7]||(o[7]=e=>P.form.estado=e),required:""},o[23]||(o[23]=[(0,a.Lk)("option",{value:"activa"},"Activa",-1),(0,a.Lk)("option",{value:"expirada"},"Expirada",-1)]),512),[[i.u1,P.form.estado]])])]),(0,a.Lk)("div",A,[(0,a.Lk)("table",null,[o[25]||(o[25]=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("th",null,"Referencia"),(0,a.Lk)("th",null,"Precio"),(0,a.Lk)("th",null,"Desc%"),(0,a.Lk)("th",null,"Impuesto"),(0,a.Lk)("th",null,"Descripción"),(0,a.Lk)("th",null,"Cantidad"),(0,a.Lk)("th",null,"Total"),(0,a.Lk)("th",null,"Acción")])],-1)),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(P.form.items,((e,o)=>((0,a.uX)(),(0,a.CE)("tr",{key:o},[(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":o=>e.referencia=o,type:"text"},null,8,V),[[i.Jo,e.referencia]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":o=>e.precio=o,type:"number"},null,8,E),[[i.Jo,e.precio,void 0,{number:!0}]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":o=>e.descuento=o,type:"number"},null,8,w),[[i.Jo,e.descuento,void 0,{number:!0}]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":o=>e.impuesto=o,type:"number"},null,8,D),[[i.Jo,e.impuesto,void 0,{number:!0}]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":o=>e.descripcion=o,type:"text"},null,8,F),[[i.Jo,e.descripcion]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":o=>e.cantidad=o,type:"number"},null,8,_),[[i.Jo,e.cantidad,void 0,{number:!0}]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":o=>e.total=o,type:"number"},null,8,J),[[i.Jo,e.total,void 0,{number:!0}]])]),(0,a.Lk)("td",null,[(0,a.Lk)("button",{type:"button",onClick:e=>X.removeItem(o)},"❌",8,S)])])))),128))])]),(0,a.Lk)("button",{type:"button",class:"add-item-button",onClick:o[8]||(o[8]=(...e)=>X.addItem&&X.addItem(...e))},"+ Agregar nueva fila")]),(0,a.Lk)("div",$,[(0,a.Lk)("div",N,[o[26]||(o[26]=(0,a.Lk)("label",{for:"subtotal"},"Subtotal*",-1)),(0,a.bo)((0,a.Lk)("input",{type:"number",id:"subtotal","onUpdate:modelValue":o[9]||(o[9]=e=>P.form.subtotal=e),required:""},null,512),[[i.Jo,P.form.subtotal,void 0,{number:!0}]])]),(0,a.Lk)("div",O,[o[27]||(o[27]=(0,a.Lk)("label",{for:"impuestos"},"Impuestos*",-1)),(0,a.bo)((0,a.Lk)("input",{type:"number",id:"impuestos","onUpdate:modelValue":o[10]||(o[10]=e=>P.form.impuestos=e),required:""},null,512),[[i.Jo,P.form.impuestos,void 0,{number:!0}]])]),(0,a.Lk)("div",q,[o[28]||(o[28]=(0,a.Lk)("label",{for:"total"},"Total*",-1)),(0,a.bo)((0,a.Lk)("input",{type:"number",id:"total","onUpdate:modelValue":o[11]||(o[11]=e=>P.form.total=e),required:""},null,512),[[i.Jo,P.form.total,void 0,{number:!0}]])])]),(0,a.Lk)("div",M,[o[29]||(o[29]=(0,a.Lk)("label",{for:"notas"},"Notas",-1)),(0,a.bo)((0,a.Lk)("textarea",{id:"notas","onUpdate:modelValue":o[12]||(o[12]=e=>P.form.notas=e),placeholder:"Agregar notas adicionales"},null,512),[[i.Jo,P.form.notas]])]),(0,a.Lk)("div",R,[(0,a.Lk)("button",{type:"button",class:"cancel-button",onClick:o[13]||(o[13]=(...e)=>X.closeModal&&X.closeModal(...e))},"Cancelar"),(0,a.Lk)("button",T,(0,l.v_)(P.isEditing?"Actualizar":"Guardar"),1)])],32)])])):(0,a.Q3)("",!0)])])])}t(4114),t(8992),t(4520),t(2577);var P=t(4373),X=t(2118),B=t(3697),W={components:{BarraLateral:X.A,Userbar:B.A},data(){return{cotizaciones:[],showModal:!1,isEditing:!1,form:{numeroCotizacion:"",cliente:"",idImpuesto:"",telefono:"",fechaCreacion:"",fechaVencimiento:"",estado:"activa",items:[{referencia:"",precio:0,descuento:0,impuesto:0,descripcion:"",cantidad:0,total:0}],subtotal:0,impuestos:0,total:0,notas:""},backendUrl:"http://localhost:3000/api/cotizacion",loading:!1}},methods:{async fetchCotizaciones(){try{this.loading=!0;const e=await P.A.get(`${this.backendUrl}/list`);this.cotizaciones=e.data}catch(e){console.error("Error al obtener las cotizaciones:",e),alert("Ocurrió un error al obtener las cotizaciones.")}finally{this.loading=!1}},openAddCotizacionModal(){this.isEditing=!1,this.resetForm(),this.showModal=!0},editCotizacion(e){const o=this.cotizaciones.find((o=>o.id===e));o?(this.isEditing=!0,this.form={...o},this.showModal=!0):alert("Cotización no encontrada.")},async deleteCotizacion(e){if(confirm("¿Estás seguro de eliminar esta cotización?"))try{this.loading=!0,await P.A.delete(`${this.backendUrl}/delete/${e}`),this.cotizaciones=this.cotizaciones.filter((o=>o.id!==e)),alert("Cotización eliminada correctamente.")}catch(o){console.error("Error al eliminar la cotización:",o),alert("No se pudo eliminar la cotización.")}finally{this.loading=!1}},async saveCotizacion(){try{this.loading=!0;const e={...this.form};if(!this.validateForm(e))return void alert("Por favor, completa todos los campos requeridos.");this.isEditing?(await P.A.put(`${this.backendUrl}/update/${this.form.id}`,e),alert("Cotización actualizada correctamente.")):(await P.A.post(`${this.backendUrl}/create`,e),alert("Cotización creada correctamente.")),this.closeModal(),this.fetchCotizaciones()}catch(e){console.error("Error al guardar la cotización:",e),alert("Ocurrió un error al guardar la cotización.")}finally{this.loading=!1}},validateForm(e){if(!e.numeroCotizacion||!e.cliente||!e.telefono||!e.fechaCreacion||!e.fechaVencimiento||!e.items.length)return!1;for(const o of e.items)if(!o.referencia||!o.precio||!o.descuento||!o.impuesto||!o.descripcion||!o.cantidad||!o.total)return!1;return!0},closeModal(){this.showModal=!1,this.resetForm()},resetForm(){this.form={numeroCotizacion:"",cliente:"",idImpuesto:"",telefono:"",fechaCreacion:"",fechaVencimiento:"",estado:"activa",items:[{referencia:"",precio:0,descuento:0,impuesto:0,descripcion:"",cantidad:0,total:0}],subtotal:0,impuestos:0,total:0,notas:""}},addItem(){this.form.items.push({referencia:"",precio:0,descuento:0,impuesto:0,descripcion:"",cantidad:0,total:0})},removeItem(e){e>-1&&e<this.form.items.length&&this.form.items.splice(e,1)}},mounted(){this.fetchCotizaciones()}},j=t(1241);const G=(0,j.A)(W,[["render",x],["__scopeId","data-v-3ba2d706"]]);var K=G}}]);
//# sourceMappingURL=534.ff11712c.js.map